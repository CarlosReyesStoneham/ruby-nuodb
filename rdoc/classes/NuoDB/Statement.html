<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>NuoDB::Statement</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>class</span>
          NuoDB::Statement
        </h1>
        <ol class='paths'>
          <li>
            <a target="docwin" href="../../files/ext/nuodb/nuodb_cpp.html">ext/nuodb/nuodb.cpp</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong><a target="docwin" href="../NuoDB.html">NuoDB</a></strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            
            <p>A <a href="Statement.html">Statement</a> object maintains a connection to a
            specific database. SQL statements are executed and results are returned
            within the context of a connection.</p>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>Public Instance</h3>
            <ol>
              <li><a target="docwin" href="#method-i-count">count</a></li>
              <li><a target="docwin" href="#method-i-execute">execute</a></li>
              <li><a target="docwin" href="#method-i-generated_keys">generated_keys</a></li>
              <li><a target="docwin" href="#method-i-results">results</a></li>
            </ol>
          </div>
          <div id='context'>
          </div>
          <div id='section'>
            <div id='methods'>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-count'>
                <a name='method-i-count'></a>
                <div class='synopsis'>
                  <span class='name'>
                    <div>count() -> Number</div>
                  </span>
                </div>
                <div class='description'>
                  
                  <p>Returns the update count for an update statement.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-count-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-count-source'>static&#x000A;VALUE nuodb_statement_update_count(VALUE self)&#x000A;{&#x000A;    trace(&quot;nuodb_statement_update_count&quot;);&#x000A;&#x000A;    nuodb_statement_handle * handle = cast_handle&lt;nuodb_statement_handle&gt;(self);&#x000A;    if (handle != NULL &amp;&amp; handle-&gt;pointer != NULL)&#x000A;    {&#x000A;        try&#x000A;        {&#x000A;            return INT2NUM(handle-&gt;pointer-&gt;getUpdateCount());&#x000A;        }&#x000A;        catch (SQLException &amp; e)&#x000A;        {&#x000A;            rb_raise_nuodb_error(e.getSqlcode(), &quot;Failed to get the update count for the statement: %s&quot;, e.getText());&#x000A;        }&#x000A;    }&#x000A;    else&#x000A;    {&#x000A;        rb_raise(rb_eArgError, &quot;invalid state: prepared statement handle nil&quot;);&#x000A;    }&#x000A;    return Qnil;&#x000A;}</pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-execute'>
                <a name='method-i-execute'></a>
                <div class='synopsis'>
                  <span class='name'>
                    <div>execute(sql) -> Bool</div>
                  </span>
                </div>
                <div class='description'>
                  
                  <p>Executes a statement.</p>
                  
                  <p>Returns true if the result is a <a href="Result.html">Result</a> object;
                  returns false if the result is an update count or there is no result. For
                  the latter case, count() should be called next, for the former case each()
                  should be called.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-execute-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-execute-source'>static&#x000A;VALUE nuodb_statement_execute(VALUE self, VALUE sql)&#x000A;{&#x000A;    if (TYPE(sql) != T_STRING)&#x000A;    {&#x000A;        rb_raise(rb_eTypeError, &quot;wrong sql argument type %s (String expected)&quot;, rb_class2name(CLASS_OF(sql)));&#x000A;    }&#x000A;&#x000A;    nuodb_statement_handle * handle = cast_handle&lt;nuodb_statement_handle&gt;(self);&#x000A;    if (handle != NULL &amp;&amp; handle-&gt;pointer != NULL)&#x000A;    {&#x000A;        try&#x000A;        {&#x000A;            return AS_QBOOL(handle-&gt;pointer-&gt;execute(StringValuePtr(sql),&#x000A;                NuoDB::RETURN_GENERATED_KEYS));&#x000A;        }&#x000A;        catch (SQLException &amp; e)&#x000A;        {&#x000A;            rb_raise_nuodb_error(e.getSqlcode(), &quot;Failed to execute SQL statement: %s&quot;, e.getText());&#x000A;        }&#x000A;    }&#x000A;    else&#x000A;    {&#x000A;        rb_raise(rb_eArgError, &quot;invalid state: prepared statement handle nil&quot;);&#x000A;    }&#x000A;}</pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-generated_keys'>
                <a name='method-i-generated_keys'></a>
                <div class='synopsis'>
                  <span class='name'>
                    <div>generated_keys() -> Results</div>
                  </span>
                </div>
                <div class='description'>
                  
                  <p>Retrieves a result set containing the generated keys related to the
                  previously executed insert.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-generated_keys-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-generated_keys-source'>static VALUE nuodb_statement_generated_keys(VALUE self)&#x000A;{&#x000A;    trace(&quot;nuodb_statement_generated_keys&quot;);&#x000A;&#x000A;    nuodb_statement_handle * handle = cast_handle&lt;nuodb_statement_handle&gt;(self);&#x000A;    if (handle != NULL &amp;&amp; handle-&gt;pointer != NULL)&#x000A;    {&#x000A;        try&#x000A;        {&#x000A;            // this hack should not have been necessary; it should never have&#x000A;            // returned null, this is a product defect.&#x000A;            ResultSet * results = handle-&gt;pointer-&gt;getGeneratedKeys();&#x000A;            if (results != NULL)&#x000A;            {&#x000A;                return nuodb_result_alloc(self, results, handle-&gt;pointer-&gt;getConnection());&#x000A;            }&#x000A;        }&#x000A;        catch (SQLException &amp; e)&#x000A;        {&#x000A;            rb_raise_nuodb_error(e.getSqlcode(), &quot;Failed to get the generated keys for the statement: %s&quot;, e.getText());&#x000A;        }&#x000A;    }&#x000A;    else&#x000A;    {&#x000A;        rb_raise(rb_eArgError, &quot;invalid state: statement handle nil&quot;);&#x000A;    }&#x000A;    return Qnil;&#x000A;}</pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-results'>
                <a name='method-i-results'></a>
                <div class='synopsis'>
                  <span class='name'>
                    <div>results() -> Results</div>
                  </span>
                </div>
                <div class='description'>
                  
                  <p>Retrieves a result set containing rows for the related query.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-results-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-results-source'>static VALUE nuodb_statement_results(VALUE self)&#x000A;{&#x000A;    trace(&quot;nuodb_statement_results&quot;);&#x000A;&#x000A;    nuodb_statement_handle * handle = cast_handle&lt;nuodb_statement_handle&gt;(self);&#x000A;    if (handle != NULL &amp;&amp; handle-&gt;pointer != NULL)&#x000A;    {&#x000A;        try&#x000A;        {&#x000A;            return nuodb_result_alloc(self, handle-&gt;pointer-&gt;getResultSet(), handle-&gt;pointer-&gt;getConnection());&#x000A;        }&#x000A;        catch (SQLException &amp; e)&#x000A;        {&#x000A;            rb_raise_nuodb_error(e.getSqlcode(), &quot;Failed to get the result set for the statement: %s&quot;, e.getText());&#x000A;        }&#x000A;    }&#x000A;    else&#x000A;    {&#x000A;        rb_raise(rb_eArgError, &quot;invalid state: statement handle nil&quot;);&#x000A;    }&#x000A;    return Qnil;&#x000A;}</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a target="docwin" href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
